function ie(e,t="ymd"){if(e=e?.trim(),!e)return new Date;let o=e?.split(/[T :\-\/.,]/g).filter(a=>!!a.trim()),n=()=>{let a=[...t].reduce((g,d,p)=>(g[d]=p,g),{}),u=o.slice(0,3),i=o.slice(3),[c,l,y,D,s,m,f]=[+u[a.y],+u[a.m]-1,+u[a.d]].concat([...Array(4)].map((g,d)=>+i[d]||0));return c<1900?new Date(new Date(c,l,y,D,s,m,f).setFullYear(c)):new Date(c,l,y,D,s,m,f)},r={get cando(){return n()},get cannot(){if(!e||o?.length<3)return console.error(`DateTools::parse: can't convert "${e||"empty date string"}" to ES-Date. Result will be current Date`),!0}};return r.cannot?new Date:r.cando}function ce(e,t){return[`${e&&!(Array.isArray(e)&&e.length<1)?`l:${e}`:""}`,`${t?`tz:${t}`:""}`].filter(o=>o).join(",")}function $(e="en-GB"){return e=S({locale:e}).locale,{long:[...Array(7).keys()].map(t=>new Date(Date.UTC(1970,0,4+t)).toLocaleDateString(e,{timeZone:"Etc/UTC",weekday:"long"})),short:[...Array(7).keys()].map(t=>new Date(Date.UTC(1970,0,4+t)).toLocaleDateString(e,{timeZone:"Etc/UTC",weekday:"short"}))}}function v(e="en-GB"){return e=S({locale:e}).locale,{long:[...Array(12).keys()].map(t=>new Date(Date.UTC(1970,t,1)).toLocaleDateString(e,{timeZone:"Etc/UTC",month:"long"})),short:[...Array(12).keys()].map(t=>new Date(Date.UTC(1970,t,1)).toLocaleDateString(e,{timeZone:"Etc/UTC",month:"short"}))}}function S({locale:e,timeZone:t,logError:o=!0}={}){let n=r=>console.error(`invalid locale (time zone: "${r.timeZone}", locale: "${r.locale}"), associated your locale instead`);try{return Intl.DateTimeFormat(e,{timeZone:t}).resolvedOptions()}catch{return o&&n({locale:e,timeZone:t}),Intl.DateTimeFormat().resolvedOptions()}}function N({locale:e,timeZone:t}={}){let o=S({locale:e,timeZone:t},!0);return Object.freeze({...o,formatOptions:ce(o.locale,o.timeZone)})}function Y(e){return Object.defineProperties(e,{clone:{value:function(o){return o?.clone()||e()}},now:{get(){return e()}},parse:{value(t,o="ymd"){return e(ie(t,o))}},localWeekdayNames:{value({locale:t,format:o}={}){return $(t,o)}},localMonthNames:{value({locale:t,format:o}={}){return v(t,o)}},daysInMonth:{value(t){return t>=1&&t<=12?new Date(1970,t,0).getDate():`${t} not between 1 and 12`}}}),e}function L(e){return e?.constructor===Date&&e||new Date}function z(e){let t=new Date;switch(!0){case e?.constructor===String:return L(new Date(e));case(Array.isArray(e)&&e.map(Number).length===e.length):return L(new Date(...e));case(e?.constructor===Date||!Number.isNaN(new Date(e))):return e}return t}var V=fe();function fe(){let[e,t,o,n]=["2-digit","numeric","long","short"],r={fixed:{MM:{month:o},M:{month:n},m:{month:t},mm:{month:e},yyyy:{year:t},yy:{year:e},WD:{weekday:o},wd:{weekday:n},d:{day:t},dd:{day:e},h:{hour:t},hh:{hour:e},mi:{minute:t},mmi:{minute:e},s:{second:t},ss:{second:e},ms:{fractionalSecondDigits:3},tz:{timeZoneName:"shortOffset"},dl:{locale:"default"},h12:{hour12:!1},yn:{yearName:""},ry:{relatedYear:!0},msp:{fractionalSecond:!0}},dynamic:{tzn:s=>({timeZoneName:s.slice(4)}),hrc:s=>({hourCycle:`h${s.slice(4)}`}),ds:s=>({dateStyle:s.slice(3)}),ts:s=>({timeStyle:s.slice(3)}),tz:s=>({timeZone:s.slice(3)}),e:s=>({era:s.slice(2)}),l:s=>({locale:s.slice(2)})}},a={...r,retrieveDyn(s){let m=s?.slice(0,s.indexOf(":"));return r.dynamic[m]&&r.dynamic[m](s)},get re(){return new RegExp(`\\b(${Object.keys(r.fixed).join("|")})\\b`,"g")}},u=(s="dtf",m=0)=>{let f=` ${s.replace(/(?<=\{)(.+?)(?=})/g,d=>`[${m++}]`).replace(/[{}]/g,"").trim()} `,g=s.match(/(?<=\{)(.+?)(?=})/g)||[];return{get texts(){return g},formatString(d){f=d},set formatStr(d){f=d},get formatStr(){return f},get units(){return f.match(a.re)||[]},finalize(d="",p="",M="",b=""){return f.replace(/~([\d+]?)/g,"$1").replace(/dtf/,d).replace(/era/,M).replace(/dp\b|~dp\b/,p).replace(/yn\b/,b).replace(/\[(\d+?)]/g,(w,le)=>g[le].trim()).trim()}}},i=s=>s.replace(/\s+/g,""),c=(...s)=>s?.reduce((m,f)=>({...m,...a.retrieveDyn(f)||a.fixed[f]}),a.fixed.dl),l=(s,m,f)=>{let g=c(...i(f).split(",")),d=Intl.DateTimeFormat(g.locale,g).format(s);return m.finalize(d)},y=(s,m,f,g)=>s.toLocaleString(m,{timeZone:f,month:g?n:o}),D=(s,m,f)=>{let g=c(...m.units.concat(i(f).split(",")).flat()),d={...a.fixed},p=(b,w)=>g[b]==="numeric"&&w.startsWith("0")?w.slice(1):w,M=Intl.DateTimeFormat(g.locale,g).formatToParts(s).reduce((b,w)=>w.type==="literal"&&/[ ,/-]/.test(w.value)?b:{...b,[w.type]:p(w.type,w.value)},{});return d.ms=g.fractionalSecondDigits?d.msp:d.ms,d.yyyy=M.relatedYear?d.ry:d.yyyy,m.formatStr=m.formatStr.replace(a.re,b=>/^(M|MM)$/.test(b)?y(s,g.locale,g.timeZone,/^M$/.test(b)):M[Object.keys(d[b]).shift()]||b),m.finalize(void 0,M.dayPeriod,M.era,M.yearName)};return(s,m,f="l:default")=>/ds:|ts:/.test(f)?l(s,u(void 0),f):D(s,u(m||void 0),f)}var H=me;function me(){let e=(n,r)=>{let a=isNaN(new Date(n)),u=isNaN(new Date(r));if(a&&!u){let[i,c,l]=Array(3).fill("start- and/or end date are not valid");return{error:!0,message:i,full:c,clean:l}}if(u){let[i,c,l]=Array(3).fill("end date not valid");return{error:!0,message:i,full:c,clean:l}}if(a){let[i,c,l]=Array(3).fill("start date not valid");return{error:!0,message:i,full:c,clean:l}}return{error:!1}},t=o();return function({start:r,end:a}={}){let u=e(r,a);if(u.error)return u;let i=Math.abs(r-a),c=new Date(i),l=c.getUTCFullYear()-1970,y=c.getUTCMonth(),D=c.getUTCDate()-1,s=c.getUTCHours(),m=c.getUTCMinutes(),f=c.getUTCSeconds(),g=c.getUTCMilliseconds(),d=Math.floor(i/1e3/60/1440),p={from:r,to:a,years:l,months:y,days:D,hours:s,minutes:m,seconds:f,milliseconds:g,diffInDays:d};return p.full=t({values:p,full:!0}),p.clean=t({values:p}),p};function o(){let n=(...l)=>y=>l.reduce((D,s)=>s(D),y),r=(l,y)=>l===1?y.slice(0,-1):y;return n(({values:l,full:y})=>[Object.entries(l).filter(([D])=>/^(years|month|days|hours|minutes|seconds)/i.test(D)),y],([l,y])=>y?l:l.filter(([,D])=>y?+D:D>0),l=>l.reduce((y,[D,s])=>[...y,`${s} ${r(s,D)}`],[]),l=>l.length<1?"Dates are equal":`${l.slice(0,-1).join(", ")}${l.length>1?" and ":""}${l.slice(-1).shift()}`)}}var _=de;function de(){let e=Object.entries({year:"FullYear",month:"Month",date:"Date",day:"Date",hour:"Hours",minute:"Minutes",second:"Seconds",millisecond:"Milliseconds"}).reduce((o,[n,r])=>({...o,[n]:r,[`${n}s`]:r}),{}),t=function(...o){let n=o.length===1,r=o[0].trim().startsWith("subtract");return r&&(o=n?o[0].trim().replace(/^subtract./i,"").split(", ").map(a=>a.trim()):o.slice(1)),n&&!r&&(o=o[0].split(",").map(a=>a.trim())),o.map(function(a){return a?a.toLowerCase().split(/ /).map(u=>{u=`${u}`.trim();let i=parseInt(u,10);return i?r?-i:+i:u}):!1}).filter(a=>a)};return function(o,...n){if(n.length<1)return o;let r=t(...n);return r.length&&r.forEach(([a,u])=>{u=e[u],+a&&u&&o[`set${u}`](o[`get${u}`]()+ +a)}),o}}var k=H(),ge=De(),h=_();function F(e,{start:t,end:o,before:n}={}){let r=e.clone().UTC;return t=T(t).UTC,!Number.isNaN(+t)&&!o?n?+r<+t:+r>+t:(o=T(o).UTC,+r>+t&&+r<+o)}function G(e,t,o){return e.localeInfo||(e.localeInfo=N()),V(new Date(e),t,o||e.localeInfo.formatOptions)}function B(e,t){t?.clone||(t=e.clone().revalue(t||e));let o=k({start:e.clone().midNight(),end:(t||e).clone().midNight()}).diffInDays;return o>0&&+t<+e?-o:o}function Q(e){let{locale:t,timeZone:o,formats:n}=e.localeInfo,r=e.format("MM|WD",n).split("|");return{locale:t,timeZone:o,monthName:r[0],dayName:r[1],dayNames:$(e.locale),monthNames:v(e.locale)}}function R(e){let[t,o,n,r]=I(e);return Object.freeze({hours:t,minutes:o,seconds:n,milliseconds:r})}function X(e){let[t,o,n]=P(e);return Object.freeze({year:t,month:o,date:n})}function J(e,{sunday:t=!1,midnight:o=!1}={}){return C(e,{day:t?"sun":"mon",midnight:o,forFirstWeekday:!0})}function I(e){return e.format("h-mi-s").split(/-/).map(Number).concat(e.getMilliseconds())}function P(e){let t=e.format("yyyy-m-d").split(/-/).map(Number);return t[1]-=1,t}function K(e){return e.format("yyyy-m-d-h-mi-s").split(/-/).map(Number).concat(e.getMilliseconds())}function U(e){return new Date(e.year,e.month+1,0,0,0,0).getDate()}function C(e,{day:t,next:o=!1,forFirstWeekday:n=!1}={}){let r=ge(t?.toLowerCase()),a=T(new Date(...e.dateValues));if(r<0)return console.log("wtf",t,r),a;let u=a.getDay();if(n&&u===r)return e;let i=o?1:-1;return c(u);function c(l){return l!==r?c(a.add(`${i} days`).getDay()):a}}function j(e){e.localeInfo||(e.localeInfo=N());let{locale:t,timeZone:o}=e.localeInfo;return new Date(e).toLocaleString(t,{timeZone:o})}function q(e){return e={timeZone:e,hourCycle:"h23"},new Date(new Date().toLocaleString("en",e))}function x(e,t){return ye(e,t||T({timeZone:"Etc/UTC"}))}function ye(e,t){if(!t.clone)return"00:00";let o=q(e.timeZone),n=q(t.timeZone),r=new Date(Math.abs(o-n)),a=o<n,[u,i]=[`${r.getHours()}`.padStart(2,"0"),`${r.getMinutes()}`.padStart(2,"0")];return`${a?"-":u==="00"&&i==="00"?"":"+"}${u}:${i}`}function ee(e,{year:t,month:o,date:n}={}){O(t)&&e.setFullYear(t),O(n)&&e.setDate(n),O(o)&&e.setMonth(o-1)}function te(e,{hours:t,minutes:o,seconds:n,milliseconds:r}={}){return O(t)&&e.setHours(t),O(o)&&e.setMinutes(o),O(n)&&e.setSeconds(n),O(r)&&e.setMilliseconds(r),e}function De(){let e={short:"sun,mon,tue,wed,thu,fri,sat".split(","),long:"sunday,monday,tuesday,wednesday,thursday,friday,saturday".split(",")};return function(t){if(!t)return-1;let o=e.short.indexOf(t);return o<0?e.long.indexOf(t):o}}function re(e){if(!e[Symbol.for("ESD")])throw new TypeError("ES-Date-Fiddler: invalid proxy");return e}function oe(e){return{addYears(t=1){return h(e,`${t} years`),e},addMonths(t=1){return h(e,`${t} months`),e},addWeeks(t=1){return h(e,`${t*7} days`),e},addDays(t=1){return h(e,`${t} days`),e},get nextYear(){return h(e,"1 year"),e},get nextWeek(){return h(e,"7 days"),e},get previousWeek(){return h(e,"subtract, 7 days"),e},get previousYear(){return h(e,"subtract, 1 year"),e},get nextMonth(){return h(e,"1 month"),e},get previousMonth(){return h(e,"subtract, 1 month"),e},get tomorrow(){return h(e,"1 day"),e},get yesterday(){return h(e,"subtract, 1 day"),e}}}function ne(e,{locale:t,timeZone:o}={}){let n={locale:t||e.locale,timeZone:o||e.timeZone};return N(n)}function ae(e,t){return!t instanceof Date?e:T(t,e.localeInfo)}function O(e){return!(Number.isNaN(parseInt(e))&&Number.isNaN(+e))}function E(e,t){let o=W(new Date(e,11,t));return o===1?E(e,t-1):o}function Z(e,t){let o=e.month;switch(!0){case o<3:return t?1:"First";case o<6:return t?2:"Second";case o<9:return t?3:"Third";case o<12:return t?4:"Fourth"}}function W(e){let t=new Date(e),o=(t.getDay()+6)%7;t.setDate(t.getDate()-o+3);let n=t.valueOf();return t.setMonth(0,1),t.getDay()!==4&&t.setMonth(0,1+(4-t.getDay()+7)%7),1+Math.ceil((n-t)/6048e5)}var A=he;function he({instance:e,localeFormats:t,localeInfo:o}={}){let n={format(r,a){return G(e,r,a)},daysUntil(r){return B(e,r)},revalue(r){return e=ae(e,r),e},firstWeekday({sunday:r=!1,midnight:a=!1}={}){return J(e,{sunday:r,midnight:a})},next(r){return C(e,{day:r,next:!0})},previous(r){return C(e,{day:r})},add(...r){return h(e,...r),e},subtract(...r){return h(e,...["subtract"].concat(r)),e},clone(){return T(new Date(e),e.localeInfo)},differenceTo(r){return k({start:e.clone(),end:r})},relocate({locale:r,timeZone:a}={}){return o=ne(e,{locale:r,timeZone:a}),e},offsetFrom(r){return x(e,r)},between(r,a){return F(e,{start:r,end:a})},isPast(r){return F(e,{start:r,before:!0})},isFuture(r){return F(e,{start:r,before:!1})},set localeInfo({locale:r,timeZone:a}){o=N({locale:r,timeZone:a,validate:!0})},set year(r){isNumberOrString(r)&&e.setFullYear(+r)},set month(r){isNumberOrString(r)&&e.setMonth(+r-1)},set hours(r){isNumberOrString(r)&&e.setHours(+r)},set minutes(r){isNumberOrString(r)&&e.setMinutes(+r)},set seconds(r){isNumberOrString(r)&&e.setSeconds(+r)},set milliseconds(r){isNumberOrString(r)&&e.setMilliseconds(+r)},set time({hours:r,minutes:a,seconds:u,milliseconds:i}={}){return te(e,{hours:r,minutes:a,seconds:u,milliseconds:i})},set date({year:r,month:a,date:u}={}){return ee(e,{year:r,month:a,date:u})},get age(){return e.differenceTo(new Date).years},get localeString(){return j(e)},get local(){return j(e)},get ISO(){return e.toISOString()},get isLeapYear(){return new Date(e.getFullYear(),2,0).getDate()===29},get names(){return Q(e)},get daysInMonth(){return U(e)},get daysThisMonth(){return U(e)},get localeInfo(){return o},get timeZone(){return(o||N()).timeZone},get locale(){return(o||N()).locale},get midnight(){return e.time={hours:0,minutes:0,seconds:0,milliseconds:0},e},get formatStr(){return t},get year(){return+e.getFullYear()},get month(){return+e.getMonth()},get dateValue(){return e.getDate()},get hours(){return e.getHours()},get minutes(){return e.getMinutes()},get seconds(){return e.getSeconds()},get milliseconds(){return e.getMilliseconds()},get time(){return R(e)},get timeValues(){return I(e)},get dateValues(){return P(e)},get dateTimeValues(){return K(e)},get date(){return X(e)},get dateTime(){return Object.freeze({...e.date,...e.time})},get UTC(){return e.clone().relocate({locale:e.locale,timeZone:"Etc/UTC"})},get UTCDiff(){return x(e)},get offsetFromUTC(){return x(e)},get day(){return e.getDay()},get weeknr(){return W(e)},get weeksInYear(){return E(e.year,31)},get weekDay(){return e.names.dayName},get monthName(){return e.names.monthName},get quarter(){return Z(e)},get quarterNr(){return Z(e,!0)}};return Object.defineProperties(n,{proxy:{value(r){return e=re(r),e},enumerable:!1},keys:{get(){return Object.keys(n).sort((r,a)=>r.localeCompare(a))}},addExtra:{value(r){let a=oe(r);Object.entries(Object.getOwnPropertyDescriptors(a)).forEach(([u,i])=>Object.defineProperty(n,u,i))},enumerable:!1}}),n}Symbol.esdProxy=Symbol.for("esdProxy");function se(e){return{get(o,n){return n in e?e[n]:t(o,n)},set(o,n,r){return typeof n!="symbol"&&n in e?(e[n]=r,r??!0):Reflect.set(...arguments)},has:(o,n)=>n in e||n in o};function t(o,n){return n in o&&o[n]instanceof Function?o[n].bind(o):o[n]}}function ue(e,t){let o=new Proxy(e,t);return o[Symbol.for("ESD")]=!0,Object.freeze(o)}var pe=be(),T=pe;function be(){return Y(e);function e(t,o){let n=z(t)||new Date,r=A();r.localeInfo=t?.locale||t?.timeZone?t:o||S();let a=r.proxy(ue(new Date(n),se(r)));return a.addExtra(a),Object.freeze(a)}}export{T as default};
